-- Gui to Lua
-- Version: 3.2

-- Instances:

local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local TextLabel = Instance.new("TextLabel")
local UICorner_2 = Instance.new("UICorner")
local TextLabel_2 = Instance.new("TextLabel")
local TextLabel_3 = Instance.new("TextLabel")
local TextButton = Instance.new("TextButton")
local UICorner_3 = Instance.new("UICorner")

--Properties:

ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false

Frame.Parent = ScreenGui
Frame.BackgroundColor3 = Color3.fromRGB(58, 58, 58)
Frame.BorderColor3 = Color3.fromRGB(0, 0, 0)
Frame.BorderSizePixel = 0
Frame.Position = UDim2.new(0.334558815, 0, 0.230769232, 0)
Frame.Size = UDim2.new(0, 441, 0, 266)
Frame.Active = true
Frame.Draggable = true

UICorner.Parent = Frame

TextLabel.Parent = Frame
TextLabel.BackgroundColor3 = Color3.fromRGB(29, 29, 29)
TextLabel.BorderColor3 = Color3.fromRGB(0, 0, 0)
TextLabel.BorderSizePixel = 0
TextLabel.Size = UDim2.new(0, 441, 0, 38)
TextLabel.Font = Enum.Font.Cartoon
TextLabel.Text = "Visual Hub"
TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.TextScaled = true
TextLabel.TextSize = 14.000
TextLabel.TextWrapped = true

UICorner_2.Parent = TextLabel

TextLabel_2.Parent = Frame
TextLabel_2.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_2.BackgroundTransparency = 1.000
TextLabel_2.BorderColor3 = Color3.fromRGB(0, 0, 0)
TextLabel_2.BorderSizePixel = 0
TextLabel_2.Position = UDim2.new(0.23582767, 0, 0, 0)
TextLabel_2.Size = UDim2.new(0, 39, 0, 38)
TextLabel_2.Font = Enum.Font.SourceSans
TextLabel_2.Text = "üëÅÔ∏è "
TextLabel_2.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_2.TextScaled = true
TextLabel_2.TextSize = 14.000
TextLabel_2.TextWrapped = true

TextLabel_3.Parent = Frame
TextLabel_3.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_3.BackgroundTransparency = 1.000
TextLabel_3.BorderColor3 = Color3.fromRGB(0, 0, 0)
TextLabel_3.BorderSizePixel = 0
TextLabel_3.Position = UDim2.new(0.682539701, 0, 0, 0)
TextLabel_3.Size = UDim2.new(0, 39, 0, 38)
TextLabel_3.Font = Enum.Font.SourceSans
TextLabel_3.Text = "üëÅÔ∏è "
TextLabel_3.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_3.TextScaled = true
TextLabel_3.TextSize = 14.000
TextLabel_3.TextWrapped = true

TextButton.Parent = Frame
TextButton.BackgroundColor3 = Color3.fromRGB(85, 255, 0)
TextButton.BorderColor3 = Color3.fromRGB(0, 0, 0)
TextButton.BorderSizePixel = 0
TextButton.Position = UDim2.new(0.272108853, 0, 0.473684222, 0)
TextButton.Size = UDim2.new(0, 200, 0, 50)
TextButton.Font = Enum.Font.Cartoon
TextButton.Text = "Execute"
TextButton.TextColor3 = Color3.fromRGB(255, 255, 255)
TextButton.TextScaled = true
TextButton.TextSize = 14.000
TextButton.TextWrapped = true
TextButton.MouseButton1Down:connect(function()
	local Players = game:GetService("Players")
	local RunService = game:GetService("RunService")

	local function createBox(character)
		local existingBox = character:FindFirstChild("esp")
		if existingBox then
			existingBox:Destroy()
		end

		local box = Instance.new("Model")
		box.Name = "esp"
		box.Parent = character

		local torso = character:FindFirstChild("UpperTorso") or character:FindFirstChild("Torso")
		if torso then
			local boxHandle = Instance.new("BoxHandleAdornment")
			boxHandle.Name = "BoxHandle"
			boxHandle.Size = Vector3.new(2, 3, 2)
			boxHandle.Adornee = torso
			boxHandle.ZIndex = 0
			boxHandle.AlwaysOnTop = true
			boxHandle.Visible = true
			boxHandle.Parent = box

			local player = Players:GetPlayerFromCharacter(character)
			if player then
				if player.Team == game.Players.LocalPlayer.Team then
					boxHandle.Color3 = Color3.fromRGB(0, 0, 255)
				elseif player.Team == nil then
					boxHandle.Color3 = Color3.fromRGB(255, 255, 255)
				else
					boxHandle.Color3 = Color3.fromRGB(255, 0, 0)
				end
			end
		end
	end

	local function createNameLabel(character, playerName)
		if character then
			local head = character:FindFirstChild("Head")
			if head then
				local existingBillboardGui = head:FindFirstChild("NameAndHealthGui")
				if existingBillboardGui then
					existingBillboardGui:Destroy()
				end

				local billboardGui = Instance.new("BillboardGui")
				billboardGui.Name = "NameAndHealthGui"
				billboardGui.Adornee = head
				billboardGui.Size = UDim2.new(0, 150, 0, 50)
				billboardGui.StudsOffset = Vector3.new(0, 2, 0)
				billboardGui.AlwaysOnTop = true
				billboardGui.Parent = head

				local textLabel = Instance.new("TextLabel")
				textLabel.Size = UDim2.new(1, 0, 1, 0)
				textLabel.BackgroundTransparency = 1
				textLabel.Text = playerName
				textLabel.TextColor3 = Color3.new(1, 1, 1)
				textLabel.TextScaled = true
				textLabel.Parent = billboardGui
			end
		end
	end

	local function applyCharacterEffects(character)
		createBox(character)
		createNameLabel(character, Players:GetPlayerFromCharacter(character).Name)
	end

	local function applyEffectsToAllPlayers()
		for _, player in pairs(Players:GetPlayers()) do
			if player.Character then
				applyCharacterEffects(player.Character)
			end
		end
	end

	applyEffectsToAllPlayers()

	Players.PlayerAdded:Connect(function(player)
		player.CharacterAdded:Connect(function(character)
			applyCharacterEffects(character)
		end)
	end)

	RunService.Heartbeat:Connect(function()
		for _, player in pairs(Players:GetPlayers()) do
			if player.Character then
				if not player.Character:FindFirstChild("esp") or
					not player.Character:FindFirstChild("NameAndHealthGui") then
					applyCharacterEffects(player.Character)
				end
			end
		end
	end)

end)

UICorner_3.Parent = TextButton
